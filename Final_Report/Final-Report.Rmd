---
title: "Haplorhini Diversity, Speciation, and Morphology"
author: "Youstina Salama"
geometry: margin=1in
output:
  pdf_document: default
fontsize: 12pt
bibliography: biblio.bib
csl: methods-in-ecology-and-evolution.csl
---

## Abstract
In discussion of primate evolution, different of opinions have persisted regarding the palaeobiology and phylogenetic relationships of early primates due to disparities in the fossil record [@Ni_2013]. In this paper I will explore Haplorhini speciation and diversification, along with their morphology using data from an online database named PaleoBiology Database. Using RStudio and Python methods, I will attempt to reconstruct some graphs generated by an R package called PaleoBioDB. I will also use a python program called PyRate which estimates speciation, extinction, and preservation rates from fossil occurrence data using a Bayesian framework [@Silvestro_2014]. In addition to providing further support for the morphological difference between different clades, the analysis shows an increase in speciation richness but a decrease in speciation rate through time.

## Introduction
Haplorhini is a clade which includes the tarsiers and the simians or anthropoids. The simians include catarrhines, which are Old World monkeys, apes, and humans, and the platyrrhines or New World monkeys. Haplorhini diverged about 60-65 million years ago. About 60 million years ago, the infraorder Tarsiiformes diverged from the haplorhines. The New World monkeys branched off from catarrhines about 40 mya, while the Hominoidea split from Old World monkeys about 25 mya. Both of the geographically separated lineages are characterized by distinct nose shape, overall structure, and mannerism with which they move. The nostrils of the New World monkeys are wide and open. The nostrils of the Old World Monkeys are narrower. Some species have long tails for climbing balance while others have shorter tails or no tails at all such as apes. Some have equal length limbs, while other do not. Some walk on four limbs such as monkeys, while others walk on two only such as Humans. The apes are the closest relatives to humans, but the exact location of humans in terms of classification remains disputable.

\begin{figure}[t]
\label{fig:pop}
\includegraphics[width=15cm, height=15cm,keepaspectratio]{images/haplo_image.jpg}
\centering
\caption{Haplorhini Image}
\end{figure}
\clearpage

## Methods
### Eploring Occurrence Data Using PaleoBioDB Package
I will be using an R package called the PaleoBioDB Package to visualize the speciation, the richness, the count, and the location of Haplorhini:
```{r, echo=F}
library(paleobioDB)
library(paleotree)
#get formal genera
#install.packages("paleobioDB")
library(paleobioDB)
#install.packages("devtools")
library(devtools)
#install_github("ropensci/paleobioDB")
library(paleobioDB)

```
I used pbdb_occurrences to download all the fossil data that belongs to Haplorhini:
```{r, eval=F}
haplorhini <-pbdb_occurrences (limit="all", vocab= "pbdb", base_name="haplorhini", show=c("coords", "phylo", "ident"))
head(haplorhini)
```

```{r, eval= F}
pbdb_map(haplorhini)
#pbdb_map returns a map with the species occurrences.
```
\begin{figure}[t]
\label{fig:pop}
\includegraphics[width=15cm, height=15cm,keepaspectratio]{images/haplomap.png}
\centering
\caption{Haplorhini Occurrence Map}
\end{figure}
\clearpage

```{r, eval= F}
pbdb_temp_range (haplorhini, rank="species")
#This returns a dataframe and a plot with the time span of species,etc..
```
\begin{figure}[t]
\label{fig:pop}
\includegraphics[width=15cm, height=15cm,keepaspectratio]{images/haplospecies.png}
\centering
\caption{Haplorhini Species}
\end{figure}
\clearpage

pbdb_richness returns a dataframe and a plot with the number of species (or genera, families, etc.) across time. I will be setting the temporal extent and the temporal resolution appropriately to show all species:
```{r, eval= F}
pbdb_richness (haplorhini, rank="species", temporal_extent=c(0,60), res=1)
```
\begin{figure}[t]
\label{fig:pop}
\includegraphics[width=15cm, height=15cm,keepaspectratio]{images/haplorichness.png}
\centering
\caption{Haplorhini Richness}
\end{figure}
\clearpage

pbdb_orig_ext returns a dataframe and a plot with the number of new appearances and last appearances of species, genera, families, etc.
```{r, eval=F}
# evolutionary rates= orig_ext=1
pbdb_orig_ext (haplorhini, rank="species", orig_ext=1, temporal_extent=c(0,60), res=1)
pbdb_orig_ext(haplorhini, rank="species", orig_ext=2, temporal_extent=c(0,60), res=1)
```
\begin{figure}[t]
\label{fig:pop}
\includegraphics[width=15cm, height=15cm,keepaspectratio]{images/haplofirstappear.png}
\centering
\caption{Haplorhini First Appearance}
\end{figure}
\clearpage

\begin{figure}[t]
\label{fig:pop}
\includegraphics[width=15cm, height=15cm,keepaspectratio]{images/haplolastappear.png}
\centering
\caption{Haplorhini Last Appearance}
\end{figure}
\clearpage

```{r, eval=F}
#this returns a plot and a dataframe with the number of species etc..
pbdb_subtaxa (haplorhini, do.plot=TRUE)  
```
\begin{figure}[t]
\label{fig:pop}
\includegraphics[width=15cm, height=15cm,keepaspectratio]{images/haplotaxa.png}
\centering
\caption{Haplorhini Number of Species}
\end{figure}
\clearpage

```{r, echo=FALSE}
# Let's graph age uncertainty of data
haplorhini <-pbdb_occurrences (limit="all", vocab= "pbdb", base_name="haplorhini", show=c("coords", "phylo", "ident"))

data(haplorhini)
head(haplorhini)
```

```{r}
occSpecies<-taxonSortPBDBocc(haplorhini, rank="species")
#plot it!
plotOccData(occSpecies)
```


```{r}
#formal grapt species in the PBDB
#genera is messier...
#get formal genera
occGenus<-taxonSortPBDBocc(haplorhini, rank="genus")

#plot it!
plotOccData(occGenus)

```

### Formatting and Visulizing Data Using ggplot
After downloading the occurrence data and diversity data from PaleoBioDB, I formatted my files from the shell using the following commands:
```{bash, eval = F}
tail -n+18 haplolist.csv > haploformatted.csv
tail -n+21 haplodiversity.csv > haplodiversity21.csv
```
```{r}
library(ggplot2)
haplodiv<-read.csv("~/Desktop/eeb-177/eeb-174-final-project/haplodiversity21.csv", as.is=T)

head(haplodiv)
```

```{r}
g<-ggplot(haplodiv, aes(interval_name, n_occs))+geom_point(color="firebrick")
g<-g+ggtitle('Interval and Number of Occurrences')
g + theme(axis.text.x=element_text(angle=50, size=7, vjust=0.5))
```
```{r}
library(ggplot2)
haplogg<-read.csv("~/Desktop/eeb-177/eeb-174-final-project/haploformatted17.csv", as.is=T)
head(haplogg)
g<-ggplot(haplogg, aes(accepted_rank, max_ma))+geom_point(color="firebrick")
g<-g+ggtitle('Rank and Max_ma')
g
plot1 <- ggplot(haplogg, aes(x=accepted_rank)) + geom_bar() + labs(title="Occurrence Count")  # Y axis derived from counts of X item
print(plot1)
```


### Visulizing Haplorhini Occurrence Using ggplot2 and forcats
```{r, echo=FALSE}
# make a plot using ggplot2
library(ggplot2)
haplo <- read.csv("~/Desktop/eeb-177/eeb-174-final-project/haplominmax4.csv", header = F, as.is = T)
names(haplo) <- c("genus", "species", "minage", "maxage")
head(haplo)
```

```{r, eval = F}
haplo_occ <- ggplot(haplo, aes( species, ymin = maxage, ymax=minage, colour = genus))
haplo_occ <- haplo_occ + geom_linerange()
haplo_occ
haplo_occ <- haplo_occ + theme(legend.position="none")
haplo_occ
haplo_occ <- haplo_occ + coord_flip()
haplo_occ
haplo_occ <- haplo_occ + theme(legend.position="none")
haplo_occ
haplo_occ <- haplo_occ +  theme(axis.text.y = element_text(size=3))
haplo_occ
haplo_occ <- haplo_occ + theme(axis.ticks.y=element_blank())
haplo_occ
haplo_occ <- haplo_occ + scale_y_continuous(limits=c(0, 40), expand = c(0, 0), breaks=c(0, 10, 20, 30, 40))
haplo_occ
haplo_occ <- haplo_occ + labs(title = "Haplorhini Fossil Occurrences", x = "Species", y = "Ma ago") + theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
haplo_occ
```

\begin{figure}[t]
\label{fig:pop}
\includegraphics[width=15cm, height=15cm,keepaspectratio]{images/haplorhini-occ.jpg}
\centering
\caption{Haplorhini Occurrences}
\end{figure}
\clearpage

I am going to use an R package called forcats to reorder the species by their minimum age. This will force ggplot to arrange the ranges so that the youngest are on top and the oldest are on the bottom.
```{r, eval= F}
#install.packages("forcats")
library(ggplot2)
library(forcats)
haplo_occ <- ggplot(haplo, aes( x = fct_reorder(species, minage, .desc = T), maxage, colour = genus))

haplo_occ2 <- haplo_occ + geom_linerange(aes(ymin = minage, ymax = maxage + 0.5)) + theme(legend.position="none") +  coord_flip() +  theme(axis.text.y = element_text(size=3)) + scale_y_continuous(limits=c(0, 50), expand = c(0, 0), breaks=c(0, 10, 20, 30, 40, 50)) + labs(title = "Haplorhini Fossil Occurrences", x = "Species", y = "Ma ago") + theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20))
haplo_occ2
```
\begin{figure}[t]
\label{fig:pop}
\includegraphics[width=15cm, height=15cm,keepaspectratio]{images/haplorhiniordered-occ.jpg}
\centering
\caption{Haplorhini Ordered Occurrences}
\end{figure}
\clearpage

```{r, eval= F}
# faceted
haplo_occ2 + geom_linerange(aes(ymin = minage, ymax = maxage + 0.5)) + theme(legend.position="none") +  coord_flip() +  theme(axis.text.y = element_text(size=3)) + scale_y_continuous(limits=c(0, 50), expand = c(0, 0), breaks=c(0, 10, 20, 30, 40, 50)) + labs(title = "Haplorhini Fossil Occurrences", x = "Species", y = "Ma ago") + theme(plot.title = element_text(hjust = 0.5, size=22, face = "bold"), axis.title =element_text(size=20)) + facet_wrap(~ genus, scales = "free")
```
\begin{figure}[t]
\label{fig:pop}
\includegraphics[width=15cm, height=15cm,keepaspectratio]{images/haplofaceted-ranges.jpg}
\centering
\caption{Haplorhini Faceted Ranges}
\end{figure}
\clearpage

```{r}
library(tidyr)
library(dplyr)
diversity <- haplo %>% gather(key = type, value = age, minage, maxage) %>% mutate(count = ifelse(type == "maxage", 1, -1)) %>% group_by(age) %>% summarise(count = sum(count))  %>% arrange(-age, -count) %>% mutate(diversity = cumsum(count)) 

ggplot(diversity, aes(x = age, y = diversity)) + geom_step()
```

### Reproducing PaleobioBD Graphs using matplot and ggplot
I will now attempt to reproduce the richness graph, but first I need to extract some data:
```{python, eval = F}
def haplofunc(filename):
    # this function opens the data file and extracts the name and maxage as a dictionary.
    haploDict = {}
    fobj = open(filename,"r", encoding = "ISO-8859-15") # this opens the file 
    reader = fobj.readlines()  # read the file
    for line in reader:   
        line = line.split(",")
        name = line[5][1:-1]
        rank = line[6][1:-1]
        min_age = line[15][1:-1]
        max_age= line[14][1:-1]
        haploDict[name] = max_age
    return haploDict
haplofunc('haploformatted.csv')
```
```{python, eval = F}
import csv
with open("/home/eeb177-student/Desktop/eeb-177/eeb-174-final-project/haploformatted.csv", newline='') as infh:
    reader = csv.reader(infh)
    for row in reader:
        if row[6] == "species":
            species = row[5]
            genus = row[5].split(" ")[0]
            print(row[5] + "," + row[15] + "," + row[14])
```

```{python, eval = F}
in_file = open("/home/eeb177-student/Desktop/eeb-177/eeb-174-final-project/haplominmax3.csv")
# read in the first line
# The first line is a header that we don't want in dictionaries
in_file.readline()
# set up empty dictionaries

species_richness = {}

# iterate through every line in the file
for line in in_file:
    #print(line)
    
    # It's a tab delimited file, so we can split the contents up into 
    # the component rows
    items = line.split(",")
    
    # Save some important pieces of information as variables
    species_name = items[1]
    max_age = float(items[3])
    
    # Use the variables to populate our three empty lists
    species_richness[species_name] = max_age

```
```{python, eval = F}

import matplotlib.pyplot as plt

# Most plotting happens on lists, not dictionaries-
# so, let's convert our data into a list
max_age = list(species_richness.values())

# We're ready to make a histogram!
plt.hist(max_age)
plt.xlabel('Time Interval (ma)')
# a y-axis label
plt.ylabel('Species Richness (frequency)')
# A main title for the graph
plt.title("Haplorhini Spcies Richness")
plt.show()

```
\begin{figure}[t]
\label{fig:pop}
\includegraphics[width=15cm, height=15cm,keepaspectratio]{images/haplo-rich.png}
\centering
\caption{Haplorhini Richness}
\end{figure}

\clearpage
```{r}
# I could also produce the same graph using ggplot2
library(ggplot2)
haplo_rich<-read.csv("~/Desktop/eeb-177/eeb-174-final-project/haplominmax3.csv", as.is=T)
head(haplo_rich)
plot1 <-ggplot(haplo_rich, aes(max_ma)) + geom_freqpoly(binwidth=3)
print(plot1)
```

### Exploring Specimen Measurements Using Matplot and ggplot2
I will extract average width and length measurements and count them in order to produce a density graph:
```{python, eval= F}
def haplomeasure(filename):
    haploDict = {}
    fobj = open(filename,"r", encoding = "ISO-8859-15") # this opens the file 
    reader = fobj.readlines()  # read the file
    for line in reader:   
        line = line.split(",")
        measurement = line[5][1:-1]
        measure_number = line[6][1:-1]
        haploDict[measurement] = measure_number
    return haploDict
    
import csv
with open("/home/eeb177-student/Desktop/eeb-177/eeb-174-final-project/haplomeasurements17.csv", newline='') as infh:
    reader = csv.reader(infh)
    counter= 1
    for row in reader:
        if row[5] == "width":
            print(str(counter) + "," + row[6] + ",")
            counter += 1
```
```{python, eval= F}
in_file = open("/home/eeb177-student/Desktop/eeb-177/eeb-174-final-project/haplomeasurewidth.csv")

in_file.readline()
# set up empty dictionaries
sizes_width = {}
sizes_mass = {}
sizes_length = {}

# iterate through every line in the file
for line in in_file:
    #print(line)
    # It's a tab delimited file, so we can split the contents up into 
    # the component rows
    items = line.split(",")
    # Save some important pieces of information as variables
    specimen_id = items[0]
    width_avg = float(items[1])
    # Use the variables to populate our three empty lists
    sizes_width[specimen_id] = width_avg
```

```{python, eval= F}
import matplotlib.pyplot as plt


# Most plotting happens on lists, not dictionaries
width_avg = list(sizes_width.values())

# We're ready to make a histogram!
plt.hist(width_avg)
plt.xlabel('Width (inch)')
# a y-axis label
plt.ylabel('Frequency')
# A main title for the graph
plt.title("Width Size distribution of Haplorhini Specimen")
plt.show()

```
\begin{figure}[t]
\label{fig:pop}
\includegraphics[width=15cm, height=15cm,keepaspectratio]{images/widthlog.png}
\centering
\caption{Average Width}
\end{figure}

\clearpage
```{python, eval= F}
# Add a log-axis to our histogram
plt.hist(width_avg, log = True)
# an X-axis label
plt.xlabel('Width (inch)')
# a y-axis label
plt.ylabel('Frequency')
# A main title for the graph
plt.title("Width Size distribution of Haplorhini Specimen")
# Let's look!
plt.show()
```
\begin{figure}[t]
\label{fig:pop}
\includegraphics[width=15cm, height=15cm,keepaspectratio]{images/width.png}
\centering
\caption{Log of Width Average}
\end{figure}

\clearpage
```{python, eval= F}
f, (ax1, ax2) = plt.subplots(1, 2,sharex = True)
ax1.hist(width_avg, log = False)
ax1.set_title('Unlogged')
ax2.hist(width_avg, log = True)
ax2.set_title('Logged')
plt.show()
```
\begin{figure}[t]
\label{fig:pop}
\includegraphics[width=15cm, height=15cm,keepaspectratio]{images/widthlog2.png}
\centering
\caption{Logged and Unlogged Graphs Side-by-side}
\end{figure}
\clearpage

```{python, eval= F}
#I would like to extract length measurements 
import csv
output = open("haplomeasurelength.csv", "w")
with open("/home/eeb177-student/Desktop/eeb-177/eeb-174-final-project/haplomeasurements17.csv", newline='') as infh:
    reader = csv.reader(infh)
    counter= 1
    for row in reader:
        if row[5] == "length":
            
            print(str(counter) + "," + row[6] + ",")
            counter += 1
```
```{python, eval= F}
in_file = open("/home/eeb177-student/Desktop/eeb-177/eeb-174-final-project/haplomeasurelength.csv")
# read in the first line
# The first line is a header that we don't want in dictionaries
in_file.readline()
# set up empty dictionaries
sizes_length = {}
# iterate through every line in the file
for line in in_file:
    #print(line)
    
    # It's a tab delimited file, so we can split the contents up into 
    # the component rows
    items = line.split(",")
    
    # Save some important pieces of information as variables
    specimen_id = items[0]
    length_avg = float(items[1])
    
    # Use the variables to populate our three empty lists
    sizes_length[specimen_id] = length_avg
```
```{python, eval= F}
import matplotlib.pyplot as plt

# Most plotting happens on lists, not dictionaries
length_avg = list(sizes_length.values())

# We're ready to make a histogram!
plt.hist(length_avg)
plt.xlabel('Length (inch)')
# a y-axis label
plt.ylabel('Frequency')
# A main title for the graph
plt.title("Length distribution of Haplorhini Specimen")
plt.show()
```
\begin{figure}[t]
\label{fig:pop}
\includegraphics[width=15cm, height=15cm,keepaspectratio]{images/length.png}
\centering
\caption{Average Length Distribution}
\end{figure}
\clearpage

```{python, eval= F}
# Add a log-axis to our histogram
plt.hist(length_avg, log = True)
# an X-axis label
plt.xlabel('Length (inch)')
# a y-axis label
plt.ylabel('Frequency')
# A main title for the graph
plt.title("Length distribution of Haplorhini Specimen")
plt.show()
```
\begin{figure}[t]
\label{fig:pop}
\includegraphics[width=15cm, height=15cm,keepaspectratio]{images/lengthlog.png}
\centering
\caption{Length Average Logged}
\end{figure}

\clearpage
```{python, eval= F}
f, (ax1, ax2) = plt.subplots(1, 2,sharex = True)
ax1.hist(length_avg, log = False)
ax1.set_title('Unlogged')
ax2.hist(width_avg, log = True)
ax2.set_title('Logged')
plt.show()
```
\begin{figure}[t]
\label{fig:pop}
\includegraphics[width=15cm, height=15cm,keepaspectratio]{images/lengthlog2.png}
\centering
\caption{Logged and Unlogged Graphs Side-by-side}
\end{figure}

\clearpage

Now using ggplot, I will produce the same graphs however I will create a gaussian graph in order to better visualize the modes of the graph:
```{r}
library(ggplot2)
haplo_width<-read.csv("~/Desktop/eeb-177/eeb-174-final-project/haplomeasurewidth.csv", as.is=T)

#head(haplo_width)
plot11 <-ggplot(haplo_width, aes(width)) + geom_density(kernel= "gaussian")
  #geom_freqpoly(binwidth=20)
print(plot11)
```
```{r}
library(ggplot2)
haplo_length<-read.csv("~/Desktop/eeb-177/eeb-174-final-project/haplomeasurelength.csv", as.is=T)

#head(haplo_length)
plot12 <-ggplot(haplo_length, aes(length)) + geom_density(kernel= "gaussian")
  #geom_freqpoly(binwidth=20)
print(plot12)
```

I can now overlay/superimpose the width and length graphs on top of each other:
```{r}
plot13 <- ggplot() + 
geom_density(data=haplo_width, aes(width), color='green') + 
geom_density(data=haplo_length, aes(length), color='red')
plot13
```

### Reproducing PaleoBioDB Fossil Map
After downloading the data from PaleoBioDB, I isolated the lonitude and latitude columns directly from the shell using the following command:
```{bash, eval = F}
tail -n+15 haplolonglat.csv | cut -d "," -f18,19 > haplolonglatoutput.csv
#I removed all double quotes around the numbers using this command:
sed 's/\"//g' haplolonglatoutput.csv > haplolonglatoutput2.csv
```
```{r}
library(ggplot2)
library(maps)

world_map <- map_data("world")

mymap <- ggplot() + coord_fixed() +
  xlab("") + ylab("")

my_world_map <- mymap + geom_polygon(data=world_map, aes(x=long, y=lat, group=group), colour="black", fill="white")

#my_world_map

#my longitude data and latitude data
haplolonglat <- read.csv("/home/eeb177-student/Desktop/eeb-177/eeb-174-final-project/haplolonglatoutput2.csv", header = T, as.is = T)
names(haplolonglat)<- c("lat", "long")
#head(haplolonglat)

haplo_map <- my_world_map + geom_point(data=haplolonglat,aes(x=long, y=lat), colour="Blue",pch=2, size=0.05, alpha=I(1)) + labs(title = "Fossil Locations Map", x = "Longitude", y = "Latitude") + theme(plot.title = element_text(hjust = 0.5, size=18, face = "bold"), axis.title =element_text(size=10))

haplo_map
```

### Pyrate 
```{python, eval= F}
#First I need to determine which species are still extant today
# this function returns the specie name and their min age
def haploextant(filename):
# this function opens data file and extracts name and minage as a dict
    haploDict = {}
    fobj = open(filename,"r", encoding = "ISO-8859-15") 
    # this opens the file 
    reader = fobj.readlines()  # read the file
    for line in reader:   
        line = line.split(",")
        name = line[5][1:-1]
        min_age = line[15][1:-1]
        haploDict[name] = min_age
    return haploDict
# However I would like only those that are extant today, with age 0
import csv
output = open("haploextant.csv", "w")
with open("/home/eeb177-student/Desktop/eeb-177/eeb-174-final-project/haploformatted.csv", newline='') as infh:
    reader = csv.reader(infh)
    for row in reader:
        if row[15] == "0":
            species = row[5]
            genus = row[5].split(" ")[0]
            output.write(row[5])
output.close() 
            
```

```{bash, eval = F}
# After writing to output file 
# I need to extract unique species to ensure lack of repetitions
less haploextant.csv | cut -d "," -f1 | sort | uniq >haploextant2.csv
less haploextant2.csv | cut -d "," -f1 | sort | uniq | wc -l
# I created a haplo_pyrate directory where I downloaded the data using:
wget -O canid_occ.csv "https://paleobiodb.org/data1.2/occs/list.csv?base_name=Haplorhini&show=acconly"
```
```{r, eval= F}
#write an R script that uses the created R script on our datafile
source("~/PyRate/pyrate_utilities.r")
extant_haplorhini = c("Chlorocebus aethiops","Colobus guereza","Homo
                      sapiens","Papio hamadryas","Theropithecus
                      oswaldi","Papio anubis","Protopithecus
                      brasiliensis","Alouatta mauroi","Papio
                      cynocephalus","Alouatta palliata","Alouatta
                      seniculus","Aotus trivirgatus","Ateles
                      geoffroyi","Ateles paniscus","Callimico
                      goeldii","Callithrix pygmaea","Cebus
                      apella","Cebus capucinus","Cebus
                      nigrivittatus","Cercopithecus
                      mitis","Cercopithecus pygerythrus","Chlorocebus
                      patas","Insulacebus toussaintiana","Lagothrix
                      lagotricha","Leontopithecus midas","Saguinus
                      fuscicollis","Saimiri sciureus")
extract.ages.pbdb(file= "haplopyr_occ.csv",extant_species=extant_haplorhini)                    
```
```{bash, eval= F}
#Let's run Pyrate!
python ~/PyRate/PyRate.py haplopyr_occ_PyRate.py -n 2500000
```

\begin{figure}[t]
\label{fig:pop}
\includegraphics[width=15cm, height=15cm,keepaspectratio]{images/haplopyr1.png}
\centering
\caption{Speciation Rate}
\end{figure}
\clearpage

\begin{figure}[t]
\label{fig:pop}
\includegraphics[width=15cm, height=15cm,keepaspectratio]{images/haplopyr2.png}
\centering
\caption{Extinction Rate}
\end{figure}
\clearpage
\clearpage

\begin{figure}[t]
\label{fig:pop}
\includegraphics[width=15cm, height=15cm,keepaspectratio]{images/haplopyr3.png}
\centering
\caption{Net Diversification Rate}
\end{figure}
\clearpage

\clearpage
\begin{figure}[t]
\label{fig:pop}
\includegraphics[width=15cm, height=15cm,keepaspectratio]{images/haplopyr4.png}
\centering
\caption{Longevity}
\end{figure}
\clearpage

## Results 
The Pyrate generated Speciation Rate graph shows a speciation rate of approximately 3 from -50 ma to -40 ma. The rate decreases to 1 from -40 ma to -20 ma, and decreases again to 0 from -20 ma to -2 ma. The rate increases again to 1 from -2 ma to 0 ma. The Pyrate generated Extinction Rate graph shows an extinction rate of approximately 3 from -50 ma to -40 ma. The rate decreases to 1 from -40 ma to -20 ma, and decreases again to 0 from -20 ma to -2 ma. The rate increases again to 1 from -2 ma to 0 ma. The Pyrate generated Net Diversification Rate shows a net diversification rate approximately -0.5 from -50 ma to -35 ma. The rate increases to 0.5 from -35 ma to -40 ma. The rate drops to 0 from -40 ma to -30 ma and increases to 0.5 from -32 ma to -20 ma. The rate drops again to 0 from -20 ma to -2 ma. From -2 ma to 0 ma, the rate drops to -0.5. The Pyrate generated Longevity graph shows a longevity of 1 myr at -50 ma, 2.5 myr at -40 ma, 1.5 myr at -30 ma, 5 myr at -20 ma, and 4 myr at -10 ma. There a spike at 0 ma to 8 myr and and a drop to 1 myrs. The ggplot and matplot graphs portraying the density of the Average Width Measurements portray bimodal gaussian graphs. The Average Length gaussian graph portrays a bimodal or possibly trimodal graph. In general, both the the width and length measurements vary greatly. Speciation richness graph shows a gradual increase in richness over time. Mapped locations of occurrences include Africa, South America, and Asia.

## Discussion

Haplorhine primates are great examples of adaptive radiation or the evolution of a group into a large range of types suited for certain living styles or locations [@Fleming_2013, @Fabre_2009]. Adaptive radiations can be seen in related groups which evolved in a  somewhat short period of time and it includes the utilization of accessible resources and habitat expanse by a specific clade. Adaptive radiation first includes a rapid occupation of habitat living space which is then followed by a decrease of diversification as habitat living space fills up slowly. The decrease of diversification indicates that the rate of habitat occupation is influenced by diversity. Generally, there is a negative relationship between diversification rate, or the difference between speciation rates and extinction rates, and species richness [@Fleming_2013]. The discussed relationship suggests that adaptive radiations will halt when accessible habitat space is full and that clade size is more likely to be independent of clade age. As habitat space gets occupied, it is expected that there would be an increase in speciation and species within clades as a consequence of competition for resources and co-evolution with food plants [@Fleming_2013]. In addition to a general increase in species richness, there is an increase in morphological diversity, also driven by competition for resources and coevolution leading to a variety of morphologically distinct species [@Fleming_2013]. Therefore, adaptive radiation involves both the production of new species and morphologies or traits [@Fleming_2013]. The bimodal graphs produced could be referring to the distinct morphologies of the two clades which diverged from Haplorhini. In general, both the width and length measurements varied greatly.

## Conclusion and Future Directions

Regarding primate evolution, varying opinions have persisted regarding the palaeobiology and phylogenetic relationships of early primates due to disparities in the fossil record. In this paper I have explored Haplorhini speciation and diversification, along with their morphology using data from an online database named PaleoBiology Database. Utilizing RStudio and Python methods, I have reconstructed some graphs generated by an R package called PaleoBioDB. I have also used a python program called PyRate which estimates speciation, extinction, and preservation rates from fossil occurrence data. In addition to providing further support for the morphological difference between different clades, the analysis shows an increase in speciation richness but a decrease in speciation rate through time. In the future, an exploration of plant and animal coevolution could shed light on the morphologies of closely interacting species and their evolution.

\clearpage

## References

